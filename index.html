<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>KFC feedback</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="https://kfclistenscx.qualtrics.com/CP/Graphic.php?IM=IM_dbC1Qsmkf9X2Bmu">
  <style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

:root {
  --kfc-red: #e4002b;
  --kfc-dark: #1d1d1d;
  --kfc-light: #ffffff;
  --gray-bg: #f4f4f4;
  --input-border: #ccc;
  --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

body {
  margin: 0;
  font-family: 'Inter', sans-serif;
  background-color: var(--gray-bg);
  color: var(--kfc-dark);
}

header {
  background-color: var(--kfc-light);
  padding: 14px 24px;
  display: flex;
  align-items: center;
  border-bottom: 3px solid var(--kfc-red);
  box-shadow: var(--shadow);
}

header img {
  height: 48px;
  margin-right: 16px;
}

header h1 {
  font-size: 22px;
  color: var(--kfc-red);
  margin: 0;
  font-weight: 600;
}

main {
  max-width: 700px;
  margin: 30px auto;
  padding: 24px;
  background: var(--kfc-light);
  border-radius: 12px;
  box-shadow: var(--shadow);
}

h2 {
  text-align: center;
  margin-bottom: 24px;
  color: var(--kfc-dark);
  font-size: 20px;
  font-weight: 600;
}

label {
  display: block;
  margin-top: 18px;
  font-weight: 600;
  font-size: 15px;
}

input[type="text"],
input[type="date"],
input[type="time"],
input[type="number"],
button {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  margin-top: 8px;
  border: 1px solid var(--input-border);
  border-radius: 6px;
  box-sizing: border-box;
  transition: 0.2s;
}

input:focus {
  outline: none;
  border-color: var(--kfc-red);
  box-shadow: 0 0 0 3px rgba(228, 0, 43, 0.1);
}

button {
  background-color: var(--kfc-red);
  color: white;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: background 0.2s;
}

button:hover {
  background-color: #b80020;
}

.link-container {
  margin-top: 30px;
}

.link-box {
  background: #ffffff;
  padding: 16px;
  border: 1px solid #ddd;
  border-radius: 10px;
  margin-bottom: 18px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s;
}

.link-box:hover {
  transform: scale(1.01);
}

.link-box a {
  color: #111;
  font-weight: 500;
  font-size: 15px;
  text-decoration: none;
  word-break: break-word;
  display: block;
  margin-bottom: 10px;
}

.link-box a:hover {
  text-decoration: underline;
}

.button-row {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
}

.button-row button {
  flex: 1;
  min-width: 120px;
  font-size: 14px;
  background-color: var(--kfc-dark);
  font-weight: 500;
}

.proxy-container {
  margin-top: 30px;
  text-align: center;
}

.proxy-container button {
  width: 48%;
  margin: 8px 1%;
  background-color: #444;
}

#qr-scanner {
  display: none;
  width: 100%;
  margin-top: 10px;
  border: 2px dashed #ccc;
  border-radius: 6px;
  padding: 10px;
}

@media (max-width: 600px) {
  main {
    margin: 20px;
    padding: 18px;
  }

  .button-row {
    flex-direction: column;
  }

  .proxy-container button {
    width: 100%;
    margin: 8px 0;
  }

  header h1 {
    font-size: 18px;
  }
}

/* –î–ª—è –Ω–∏–∫–Ω–µ–π–º–∞ –≤ —Ö–µ–¥–µ—Ä–µ */
.nickname {
  margin-left: auto;
  font-weight: 500;
  color: #888;
  font-size: 16px;
  opacity: 0.7;
  transition: opacity 0.3s ease;
}

.nickname:hover {
  opacity: 1;
  color: var(--kfc-red);
}

.material-symbols-outlined {
  font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 28;
  cursor: pointer;

  /* –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ–º —Ñ–æ–Ω –∏ —Ä–∞–º–∫—É */
  border: none;
  background: transparent;
  color: var(--kfc-dark);

  /* –£–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–±–≤–æ–¥–∫–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ/–∫–ª–∏–∫–µ */
  outline: none;
  box-shadow: none;

  /* –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —Ü–≤–µ—Ç–∞ */
  transition: color 0.2s;
}

.material-symbols-outlined:hover {
  color: var(--kfc-red);
}

/* –î–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏/—Ñ–æ–∫—É—Å–µ */
.material-symbols-outlined:active,
.material-symbols-outlined:focus {
  background: transparent;
  outline: none;
  box-shadow: none;
}

  </style>

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
<style>
.material-symbols-outlined {
  font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 28;
  cursor: pointer;
  border: none;
  background: none;
  color: var(--kfc-dark);
  margin-left: 10px;
  transition: color 0.2s;
}

.material-symbols-outlined:hover {
  color: var(--kfc-red);
}
/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.scan-row {
  display: flex;
  align-items: center; /* üî• –í–ê–ñ–ù–û */
  gap: 10px;
}
	
/* –ö–Ω–æ–ø–∫–∞ Camera */
.camera-btn {
  flex: 1;
  height: 48px;
  background-color: var(--kfc-red);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;

  display: flex;
  align-items: center;
  justify-content: center;

  line-height: 1; /* üî• —Ñ–∏–∫—Å iOS */
}

/* –ö–Ω–æ–ø–∫–∞ Upload ‚Äî –ö–í–ê–î–†–ê–¢ */
.upload-btn {
  width: 48px;
  height: 48px;
  background-color: var(--kfc-red);
  border-radius: 8px;
  cursor: pointer;
  flex-shrink: 0;

  display: flex;
  align-items: center;
  justify-content: center;

  padding: 0;
  margin: 0;              /* üî• –í–ê–ñ–ù–û */
  line-height: 0;         /* üî• –í–ê–ñ–ù–û */
  vertical-align: middle; /* üî• –í–ê–ñ–ù–û */
}

.upload-btn:hover {
  background-color: #b80020;
}

/* –ò–∫–æ–Ω–∫–∞ Upload –ø–æ —Ü–µ–Ω—Ç—Ä—É */
.upload-btn .material-symbols-outlined {
  font-size: 26px;
  color: white;
  display: flex;          /* üî• */
  align-items: center;    /* üî• */
  justify-content: center;/* üî• */
  line-height: 1;
}

	.auth-actions {
  margin-left: auto; /* üî• –û–¢–ü–†–ê–í–õ–Ø–ï–¢ –ö–ù–û–ü–ö–£ –í–ü–†–ê–í–û */
  display: flex;
  align-items: center;
}

#loginBtn,
#logoutBtn {
  font-size: 26px; /* –±—ã–ª–æ 28 */
}
	
</style>
	
</head>
<body>




<header id="pageHeader">
  <img src="https://kfclistenscx.qualtrics.com/CP/Graphic.php?IM=IM_dbC1Qsmkf9X2Bmu" alt="KFC Logo">
  <h1>KFC feedback</h1>


  <!-- –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google (–∏–∫–æ–Ω–∫–∞) -->
<div class="auth-actions">
  <button id="loginBtn" class="material-symbols-outlined">login</button>
  <button id="logoutBtn" class="material-symbols-outlined" style="display:none;">logout</button>
</div>
</header>

	


	

  <div class="nickname" id="nickname">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</div>

	

<!-- üîê –ó–∞—â–∏—â—ë–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
<div id="protected-content" style="display:none;">

	
<main>
  <h2>GenereazƒÉ linkuri pentru feedback</h2>

  <label>1. ScaneazƒÉ QR sau √ÆncarcƒÉ o imagine:</label>
  <div class="scan-row">
  <button class="camera-btn" onclick="startQRScanner()">
    üì∑ CamerƒÉ
  </button>

  <label class="upload-btn">
    <span class="material-symbols-outlined">upload</span>
    <input type="file" id="imageInput" accept="image/*" hidden>
  </label>
</div>
  <div id="qr-scanner"></div>

  <label>2. Link din QR:</label>
  <input type="text" id="scannedResult" placeholder="Aici apare linkul scanat">

  <label>3. DatƒÉ (implicit astƒÉzi):</label>
  <input type="date" id="selectedDate">

  <label>4. Ora de √Ænceput:</label>
  <input type="time" id="startTime">

  <label>5. Ora de sf√¢r»ôit:</label>
  <input type="time" id="endTime">

  <label>6. C√¢te linkuri sƒÉ se genereze:</label>
  <input type="number" id="linkCount" value="10">

  <button onclick="generateLinks()">üîó GenereazƒÉ linkuri</button>

  <div id="links" class="link-container"></div>

  <div class="proxy-container">
    <button onclick="window.open('https://proxyium.com', '_blank')">üåê Deschide Proxyium</button>
    <button onclick="window.open('https://www.croxyproxy.com', '_blank')">üåê Deschide CroxyProxy</button>
  </div>
  <button onclick="clearUsedLinks()" style="background:#555;color:#fff;width:100%;margin-top:20px;">üßπ CurƒÉ»õƒÉ linkuri folosite</button>

</main>
	
<script>
  function copyLink(link) {
    navigator.clipboard.writeText(link).then(() => {
      alert("Link copiat!");
    });
  }

  function openProxyium(link) {
    // –ü—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ–º —É–∂–µ –≥–æ—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É, –±–µ–∑ encodeURIComponent!
    navigator.clipboard.writeText(link).then(() => {
      window.open("https://www.proxyium.com", "_blank");
    });
  }

  function openCroxy(link) {
    navigator.clipboard.writeText(link).then(() => {
      window.open("https://www.croxyproxy.com", "_blank");
    });
  }
  // SalvƒÉm linkurile folosite
function markLinkAsUsed(link) {
  let used = JSON.parse(localStorage.getItem("usedLinks") || "[]");
  if (!used.includes(link)) {
    used.push(link);
    localStorage.setItem("usedLinks", JSON.stringify(used));
  }
}

// VerificƒÉm dacƒÉ linkul a fost folosit deja
function isLinkUsed(link) {
  let used = JSON.parse(localStorage.getItem("usedLinks") || "[]");
  return used.includes(link);
}

// »òterge toate linkurile folosite
function clearUsedLinks() {
  localStorage.removeItem("usedLinks");
  alert("Linkurile folosite au fost »ôterse!");
  location.reload();
}

</script>



<script src="https://unpkg.com/html5-qrcode"></script>
<script>
  let html5QrCode;

  function setDefaultDateTime() {
    const now = new Date();
    document.getElementById("selectedDate").valueAsDate = now;
    document.getElementById("startTime").value = "10:00";
    document.getElementById("endTime").value = now.toTimeString().slice(0, 5);
  }

  function startQRScanner() {
    const scannerDiv = document.getElementById("qr-scanner");
    scannerDiv.style.display = "block";
    html5QrCode = new Html5Qrcode("qr-scanner");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      qrCodeSuccess
    ).catch(err => alert("Eroare camerƒÉ: " + err));
  }

  function qrCodeSuccess(decodedText) {
    document.getElementById("scannedResult").value = decodedText;
    html5QrCode.stop().then(() => {
      document.getElementById("qr-scanner").style.display = "none";
    });
  }

  document.getElementById("imageInput").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;
    const qr = new Html5Qrcode("qr-scanner");
    qr.scanFile(file, true).then(decodedText => {
      document.getElementById("scannedResult").value = decodedText;
    }).catch(() => alert("QR nu a fost gƒÉsit √Æn imagine"));
  });

  function parseLinkData(link) {
    const url = new URL(link);
    const params = new URLSearchParams(url.search);
    return {
      S: params.get("S"),
      dateTime: decodeURIComponent(params.get("D")),
      TI: parseInt(params.get("TI")),
      lang: params.get("Q_Language") || "RO"
    };
  }

  function generateLinks() {
    const link = document.getElementById("scannedResult").value.trim();
    const date = document.getElementById("selectedDate").value;
    const startTime = document.getElementById("startTime").value;
    const endTime = document.getElementById("endTime").value;
    const count = parseInt(document.getElementById("linkCount").value);

    if (!link || !date || !startTime || !endTime || !count) {
      alert("CompleteazƒÉ toate c√¢mpurile!");
      return;
    }

    const data = parseLinkData(link);
    const base = "https://customer.kfc-listens.com/jfe/form/SV_7WmLtfIDJuM3Vn8";
    const start = new Date(`${date}T${startTime}`);
    const end = new Date(`${date}T${endTime}`);
    const now = new Date();

    if (end < start) {
      alert("Ora de sf√¢r»ôit nu poate fi √Ænaintea celei de √Ænceput!");
      return;
    }
    if (end > now) {
      alert("Ora de sf√¢r»ôit nu poate fi √Æn viitor!");
      return;
    }

    const diff = (end - start) / count;
    let linksHTML = "";

    for (let i = 0; i < count; i++) {
      const ti = data.TI - (count - i - 1);
      const time = new Date(start.getTime() + diff * i);
      const dd = String(time.getDate()).padStart(2, "0");
      const mm = String(time.getMonth() + 1).padStart(2, "0");
      const yyyy = time.getFullYear();
      const hh = String(time.getHours()).padStart(2, "0");
      const mi = String(time.getMinutes()).padStart(2, "0");

      const encodedDateTime = encodeURIComponent(`${dd}/${mm}/${yyyy}%20${hh}:${mi}`);
      const fullLink = `${base}?S=${data.S}&D=${encodedDateTime}&TI=${ti}&Q_Language=${data.lang}`;

     if (isLinkUsed(fullLink)) continue;

linksHTML += `<div class="link-box">
  <a href="${fullLink}" target="_blank">${decodeURIComponent(fullLink)}</a>
  <div class="button-row">
    <button onclick="copyAndMark('${fullLink}')">üìã CopiazƒÉ</button>
    <button onclick="openAndMark('${fullLink}')">üîì Deschide</button>
    <button onclick="openProxyium('${fullLink}', event)">üåêVPNProxyium</button>
	<button onclick="openCroxy('${fullLink}', event)">üõ°Ô∏èVPNCroxyProxy</button>
  </div>
</div>`;


    }

    document.getElementById("links").innerHTML = linksHTML;
  }
  function copyLink(text) {
    navigator.clipboard.writeText(decodeURIComponent(text))
      .then(() => alert("Copiat!"))
      .catch(() => alert("Copierea nu a reu»ôit"));
  }

function copyAndMark(link) {
  copyLink(link);
  markLinkAsUsed(link);
  event.target.closest('.link-box').style.opacity = 0.4;
}

function openAndMark(link) {
  window.open(decodeURIComponent(link), '_blank');
  markLinkAsUsed(link);
  event.target.closest('.link-box').style.opacity = 0.4;
}


function openProxyium(link, event) {
  const decodedLink = decodeURIComponent(link);
  navigator.clipboard.writeText(decodedLink).then(() => {
    markLinkAsUsed(link);
    event.target.closest('.link-box').style.opacity = 0.4;
    window.open("https://www.proxyium.com", "_blank");
  });
}

function openCroxy(link, event) {
  const decodedLink = decodeURIComponent(link);
  navigator.clipboard.writeText(decodedLink).then(() => {
    markLinkAsUsed(link);
    event.target.closest('.link-box').style.opacity = 0.4;
    window.open("https://www.croxyproxy.com", "_blank");
  });
}


  setDefaultDateTime();

</script>
</body>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDMO3a9eUai1bjx7K7dHsBP9FWST7uPFwI",
    authDomain: "kfc-malldova-link.firebaseapp.com",
    projectId: "kfc-malldova-link",
    storageBucket: "kfc-malldova-link.firebasestorage.app",
    messagingSenderId: "674846762418",
    appId: "1:674846762418:web:a0199fed7c41af71fd30ab"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const provider = new GoogleAuthProvider();

  window.loginWithGoogle = async () => {
    try { await signInWithPopup(auth, provider); }
    catch (error) { console.error("Login error:", error); }
  };

  const loginBtn = document.getElementById("loginBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const nicknameDiv = document.getElementById("nickname");
  const protectedContent = document.getElementById("protected-content");

  // –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞
  loginBtn.onclick = () => loginWithGoogle();

  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      nicknameDiv.innerText = "–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω";
      protectedContent.style.display = "none";
      logoutBtn.style.display = "none";
      loginBtn.style.display = "inline-block"; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ö–æ–¥
      return;
    }

    const userRef = doc(db, "users", user.uid);
    const snap = await getDoc(userRef);

    if (!snap.exists()) {
      await setDoc(userRef, { name: user.displayName, email: user.email, blocked: false, createdAt: new Date() });
    } else if (snap.data().blocked === true) {
      alert("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω");
      await signOut(auth);
      protectedContent.style.display = "none";
      logoutBtn.style.display = "none";
      loginBtn.style.display = "inline-block";
      return;
    }

    nicknameDiv.innerText = `–ü—Ä–∏–≤–µ—Ç, ${user.displayName}`;
    protectedContent.style.display = "block";
    loginBtn.style.display = "none";        // —Å–∫—Ä—ã–≤–∞–µ–º –≤—Ö–æ–¥
    logoutBtn.style.display = "inline-block"; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã—Ö–æ–¥
  });

  // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
  logoutBtn.onclick = async () => {
    await signOut(auth);
    nicknameDiv.innerText = "–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω";
    protectedContent.style.display = "none";
    logoutBtn.style.display = "none";
    loginBtn.style.display = "inline-block"; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ö–æ–¥
  };

/* ===== AUTH ICON BUTTONS (LOGIN / LOGOUT) ===== */
.auth-actions button {
  all: unset;                 /* üí£ –°–ù–û–°–ò–¢ –í–°–ï –°–¢–ò–õ–ò button */
  cursor: pointer;

  display: flex;
  align-items: center;
  justify-content: center;

  width: 32px;
  height: 32px;

  font-family: 'Material Symbols Outlined';
  font-size: 26px;
  line-height: 1;

  color: var(--kfc-dark);
  background: transparent;    /* üî• –í–°–ï–ì–î–ê –ü–†–û–ó–†–ê–ß–ù–´–ô */
}

/* Hover */
.auth-actions button:hover {
  color: var(--kfc-red);
}

/* Active / focus ‚Äî –ù–ò–ö–ê–ö–û–ì–û –ö–†–ê–°–ù–û–ì–û –§–û–ù–ê */
.auth-actions button:active,
.auth-actions button:focus {
  background: transparent;
  outline: none;
  box-shadow: none;
}
	
</script>
	
</div>
	
</html>







